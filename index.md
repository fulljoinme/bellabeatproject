Bellabeat Market Opportunities Analysis
================
Yi Huang
2023-04-01

- <a href="#1-about-bellabeat" id="toc-1-about-bellabeat">1. ABOUT
  BELLABEAT</a>
- <a href="#2-ask" id="toc-2-ask">2. ASK</a>
  - <a href="#21-the-business-task" id="toc-21-the-business-task">2.1. The
    Business Task</a>
  - <a href="#22-stakeholders" id="toc-22-stakeholders">2.2 Stakeholders</a>
- <a href="#3-prepare" id="toc-3-prepare">3. PREPARE</a>
  - <a href="#31-the-dataset" id="toc-31-the-dataset">3.1. The dataset</a>
  - <a href="#32-install-packages-and-library"
    id="toc-32-install-packages-and-library">3.2. Install packages and
    library</a>
  - <a href="#33-load-csv-files-and-create-name-for-each-dataframe"
    id="toc-33-load-csv-files-and-create-name-for-each-dataframe">3.3. Load
    CSV files and create name for each dataframe</a>
  - <a href="#34-explore-the-datasets" id="toc-34-explore-the-datasets">3.4.
    Explore the Datasets</a>
- <a href="#4-process" id="toc-4-process">4. PROCESS</a>
  - <a href="#41-handling-missing-value"
    id="toc-41-handling-missing-value">4.1. Handling Missing value</a>
  - <a href="#42-handling-duplicates" id="toc-42-handling-duplicates">4.2.
    Handling Duplicates</a>
  - <a href="#43-handling-date--time-datatype"
    id="toc-43-handling-date--time-datatype">4.3. Handling date &amp; time
    datatype</a>
  - <a href="#44-renaming-datafile" id="toc-44-renaming-datafile">4.4.
    Renaming datafile</a>
- <a href="#5-analyze-and-visualize" id="toc-5-analyze-and-visualize">5.
  ANALYZE AND VISUALIZE</a>
  - <a href="#51-statistic-summary-of-overall-daily_activity-and-sleep_day"
    id="toc-51-statistic-summary-of-overall-daily_activity-and-sleep_day">5.1.
    Statistic Summary of overall daily_activity and sleep_day</a>
- <a href="#visualize-the-data-distrubution-of-the-daily-activities"
  id="toc-visualize-the-data-distrubution-of-the-daily-activities">Visualize
  the data distrubution of the daily activities.</a>
  - <a
    href="#53-is-there-any-difference-in-calories-burned-in-different-days-in-a-week"
    id="toc-53-is-there-any-difference-in-calories-burned-in-different-days-in-a-week">5.3.
    Is there any difference in calories burned in different days in a
    week?</a>
  - <a
    href="#54-is-there-any-difference-in-sleep-in-different-days-in-a-week"
    id="toc-54-is-there-any-difference-in-sleep-in-different-days-in-a-week">5.4.
    Is there any difference in sleep in different days in a week?</a>
- <a href="#add-new-column--weekday-and-then-calculate-the-mean-and-sd"
  id="toc-add-new-column--weekday-and-then-calculate-the-mean-and-sd">Add
  new column – Weekday, and then calculate the mean and sd.</a>
  - <a href="#55-hourly-steps-intensities-and-calories"
    id="toc-55-hourly-steps-intensities-and-calories">5.5 Hourly Steps,
    Intensities and Calories</a>
  - <a
    href="#56relationship-between-total-steps-taken-and-being-sedentary-in-a-day"
    id="toc-56relationship-between-total-steps-taken-and-being-sedentary-in-a-day">5.6.Relationship
    between total steps taken and being sedentary in a day.</a>
  - <a href="#57-relationship-between-minutes-asleep-and-time-in-bed"
    id="toc-57-relationship-between-minutes-asleep-and-time-in-bed">5.7.
    Relationship between minutes asleep and time in bed</a>
  - <a href="#6-act-recommendation-and-conclusion"
    id="toc-6-act-recommendation-and-conclusion">6. ACT: Recommendation and
    Conclusion</a>

## 1. ABOUT BELLABEAT

Bellabeat is a high-tech manufacturer of health focused products for
women. Bellabeat products include Bellabeat app, Leaf, Time and Spring.
Each products has its uniqueness in helping a woman to achieve her
health goal. <br> <br>

## 2. ASK

### 2.1. The Business Task

The project aims to analyze consumer behavior and usage patterns of the
Leaf tracker, connecting to the Bellabeat app to track activity, sleep,
and stress. Non-Bellabeat smart devices’ datasets will be analyzed to
provide broader insights. Data analytics techniques will be used to
identify trends and patterns in consumer behavior, guiding Bellabeat’s
product development and marketing strategies. Ultimately, this project
will help Bellabeat improve its products to meet customers’ needs and
preferences in a competitive market.

### 2.2 Stakeholders

- *Urška Sršen*: Bellabeat’s cofounder and Chief Creative Officer
- *Sando Mur*: Mathematician and Bellabeat’s cofounder; key member of
  the Bellabeat executive team
- *Bellabeat marketing analytics team*: A team of data analysts
  responsible for collecting, analyzing, and reporting data that helps
  guide Bellabeat’s marketing strategy. I am the *junior analyst* on
  this team. <br> <br>

## 3. PREPARE

### 3.1. The dataset

Data source for this project was from:
<https://www.kaggle.com/arashnic/fitbit>. This dataset was created from
a survey via Amazon Mechanical Turk over 31 days (4/12/2016-5/12/2016),
with 33 Fitbit users submitting data on physical activity, heart rate,
and sleep monitoring. The data varied based on the type of Fitbit
tracker used and individual tracking behaviors. The data is licensed
under CC0: Public Domain, allowing for unrestricted use, modification,
and distribution without permission, even for commercial purposes.

This analysis begin on: 2023-03-28

### 3.2. Install packages and library

``` r
library(tidyverse) # A must have 
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.1     ✔ readr     2.1.4
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.0
    ## ✔ ggplot2   3.4.1     ✔ tibble    3.2.1
    ## ✔ lubridate 1.9.2     ✔ tidyr     1.3.0
    ## ✔ purrr     1.0.1     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(ggpubr) # stat_cor()
library(gridExtra) # for arranging multuple plot on a single page 
```

    ## 
    ## Attaching package: 'gridExtra'
    ## 
    ## The following object is masked from 'package:dplyr':
    ## 
    ##     combine

### 3.3. Load CSV files and create name for each dataframe

``` r
daily_activity <- read.csv("dailyActivity_merged.csv")
sleep_day <- read.csv("sleepDay_merged.csv")
hourly_calories <- read.csv("hourlyCalories_merged.csv")
hourly_intensities <- read.csv("hourlyIntensities_merged.csv")
hourly_steps <- read.csv("hourlySteps_merged.csv")
heartrate_seconds <- read.csv("heartrate_seconds_merged.csv")
weight_log <- read.csv("weightLogInfo_merged.csv")
```

### 3.4. Explore the Datasets

``` r
# use head() and str() to make sure datasets are loaded correctly. 
head(daily_activity)
```

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366    4/12/2016      13162          8.50            8.50
    ## 2 1503960366    4/13/2016      10735          6.97            6.97
    ## 3 1503960366    4/14/2016      10460          6.74            6.74
    ## 4 1503960366    4/15/2016       9762          6.28            6.28
    ## 5 1503960366    4/16/2016      12669          8.16            8.16
    ## 6 1503960366    4/17/2016       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories
    ## 1                  13                  328              728     1985
    ## 2                  19                  217              776     1797
    ## 3                  11                  181             1218     1776
    ## 4                  34                  209              726     1745
    ## 5                  10                  221              773     1863
    ## 6                  20                  164              539     1728

``` r
head(sleep_day)
```

    ##           Id              SleepDay TotalSleepRecords TotalMinutesAsleep
    ## 1 1503960366 4/12/2016 12:00:00 AM                 1                327
    ## 2 1503960366 4/13/2016 12:00:00 AM                 2                384
    ## 3 1503960366 4/15/2016 12:00:00 AM                 1                412
    ## 4 1503960366 4/16/2016 12:00:00 AM                 2                340
    ## 5 1503960366 4/17/2016 12:00:00 AM                 1                700
    ## 6 1503960366 4/19/2016 12:00:00 AM                 1                304
    ##   TotalTimeInBed
    ## 1            346
    ## 2            407
    ## 3            442
    ## 4            367
    ## 5            712
    ## 6            320

``` r
head(hourly_calories)
```

    ##           Id          ActivityHour Calories
    ## 1 1503960366 4/12/2016 12:00:00 AM       81
    ## 2 1503960366  4/12/2016 1:00:00 AM       61
    ## 3 1503960366  4/12/2016 2:00:00 AM       59
    ## 4 1503960366  4/12/2016 3:00:00 AM       47
    ## 5 1503960366  4/12/2016 4:00:00 AM       48
    ## 6 1503960366  4/12/2016 5:00:00 AM       48

``` r
head(hourly_intensities)
```

    ##           Id          ActivityHour TotalIntensity AverageIntensity
    ## 1 1503960366 4/12/2016 12:00:00 AM             20         0.333333
    ## 2 1503960366  4/12/2016 1:00:00 AM              8         0.133333
    ## 3 1503960366  4/12/2016 2:00:00 AM              7         0.116667
    ## 4 1503960366  4/12/2016 3:00:00 AM              0         0.000000
    ## 5 1503960366  4/12/2016 4:00:00 AM              0         0.000000
    ## 6 1503960366  4/12/2016 5:00:00 AM              0         0.000000

``` r
head(hourly_steps)
```

    ##           Id          ActivityHour StepTotal
    ## 1 1503960366 4/12/2016 12:00:00 AM       373
    ## 2 1503960366  4/12/2016 1:00:00 AM       160
    ## 3 1503960366  4/12/2016 2:00:00 AM       151
    ## 4 1503960366  4/12/2016 3:00:00 AM         0
    ## 5 1503960366  4/12/2016 4:00:00 AM         0
    ## 6 1503960366  4/12/2016 5:00:00 AM         0

``` r
head(heartrate_seconds)
```

    ##           Id                 Time Value
    ## 1 2022484408 4/12/2016 7:21:00 AM    97
    ## 2 2022484408 4/12/2016 7:21:05 AM   102
    ## 3 2022484408 4/12/2016 7:21:10 AM   105
    ## 4 2022484408 4/12/2016 7:21:20 AM   103
    ## 5 2022484408 4/12/2016 7:21:25 AM   101
    ## 6 2022484408 4/12/2016 7:22:05 AM    95

``` r
head(weight_log)
```

    ##           Id                  Date WeightKg WeightPounds Fat   BMI
    ## 1 1503960366  5/2/2016 11:59:59 PM     52.6     115.9631  22 22.65
    ## 2 1503960366  5/3/2016 11:59:59 PM     52.6     115.9631  NA 22.65
    ## 3 1927972279  4/13/2016 1:08:52 AM    133.5     294.3171  NA 47.54
    ## 4 2873212765 4/21/2016 11:59:59 PM     56.7     125.0021  NA 21.45
    ## 5 2873212765 5/12/2016 11:59:59 PM     57.3     126.3249  NA 21.69
    ## 6 4319703577 4/17/2016 11:59:59 PM     72.4     159.6147  25 27.45
    ##   IsManualReport        LogId
    ## 1           True 1.462234e+12
    ## 2           True 1.462320e+12
    ## 3          False 1.460510e+12
    ## 4           True 1.461283e+12
    ## 5           True 1.463098e+12
    ## 6           True 1.460938e+12

Note that all data files have date-time in ‘chr’ datatype, which need to
be converted to datetime datatype for further analysis. This conversion
will be performed in step 4.3. Handling date & time datatype issue.

``` r
# Number of unique participants in each dataframes
n_distinct(daily_activity$Id)
```

    ## [1] 33

``` r
n_distinct(sleep_day$Id)
```

    ## [1] 24

``` r
n_distinct(hourly_calories$Id)
```

    ## [1] 33

``` r
n_distinct(hourly_intensities$Id)
```

    ## [1] 33

``` r
n_distinct(hourly_steps$Id)
```

    ## [1] 33

``` r
n_distinct(heartrate_seconds$Id)
```

    ## [1] 14

``` r
n_distinct(weight_log$Id)
```

    ## [1] 8

Note that the datasets sleeps_day(24 participants), heartrate_seconds
(14 participants) and weight_log (8 participants) have a low participant
number. **Analysis conducted using these datasets should be used with
caution**.

The dataset heartrate_seconds has a misleading file name because the
data set shows heartrate per minute instead of per second. I will rename
this dataset in step 4.4 - Renaming Datafile. While heartrate per minute
itself is not a very useful piece of information, it should not be
overlooked due to its potential value.

Further discussion on the weight_log and heart_rate data will be
included in the final section on recommendation and conclusion. Overall
total sample number is low. Any analysis resulted from these data should
be use with caution. <br> <br>

## 4. PROCESS

### 4.1. Handling Missing value

``` r
# Check for number of missing value in each dataset 
sum(is.na(daily_activity))
```

    ## [1] 0

``` r
sum(is.na(sleep_day))
```

    ## [1] 0

``` r
sum(is.na(hourly_calories))
```

    ## [1] 0

``` r
sum(is.na(hourly_intensities))
```

    ## [1] 0

``` r
sum(is.na(hourly_steps))
```

    ## [1] 0

**There is no missing values in all 5 datasets above**

### 4.2. Handling Duplicates

``` r
# Check for number of duplicates in each dataset. 
sum(duplicated(daily_activity))
```

    ## [1] 0

``` r
sum(duplicated(sleep_day))
```

    ## [1] 3

``` r
sum(duplicated(hourly_calories))
```

    ## [1] 0

``` r
sum(duplicated(hourly_intensities))
```

    ## [1] 0

``` r
sum(duplicated(hourly_steps))
```

    ## [1] 0

Note that **the sleep_day dataset contains three rows of duplicated
data**. The next step is to remove the duplicated rows from sleep_day
and save them into a new dataframe named sleep_day2.

``` r
# remove duplicates and save into new dataframe sleep_day2. 
sleep_day2 <- sleep_day[!duplicated(sleep_day),] #!duplicated(sleep_day)  -- include only non-duplicated rows 
nrow(sleep_day2)
```

    ## [1] 410

``` r
sum(duplicated(sleep_day2)) # check if there is any duplicates. 
```

    ## [1] 0

Duplicates in sleep_day were removed and saved as sleep_day2. Total row
in sleep_day was 413, came down to 410 rows in sleep_day2.

### 4.3. Handling date & time datatype

``` r
# Coverting to date or datetime datatype.  
# To make sure the date in the correct date format for daily_activity and sleep_day
daily_activity <- daily_activity %>% 
    rename(ActivityDate = ActivityDate) %>% 
    mutate(ActivityDate = as_date(ActivityDate, format = "%m/%d/%Y")) 
head(daily_activity)
```

    ##           Id ActivityDate TotalSteps TotalDistance TrackerDistance
    ## 1 1503960366   2016-04-12      13162          8.50            8.50
    ## 2 1503960366   2016-04-13      10735          6.97            6.97
    ## 3 1503960366   2016-04-14      10460          6.74            6.74
    ## 4 1503960366   2016-04-15       9762          6.28            6.28
    ## 5 1503960366   2016-04-16      12669          8.16            8.16
    ## 6 1503960366   2016-04-17       9705          6.48            6.48
    ##   LoggedActivitiesDistance VeryActiveDistance ModeratelyActiveDistance
    ## 1                        0               1.88                     0.55
    ## 2                        0               1.57                     0.69
    ## 3                        0               2.44                     0.40
    ## 4                        0               2.14                     1.26
    ## 5                        0               2.71                     0.41
    ## 6                        0               3.19                     0.78
    ##   LightActiveDistance SedentaryActiveDistance VeryActiveMinutes
    ## 1                6.06                       0                25
    ## 2                4.71                       0                21
    ## 3                3.91                       0                30
    ## 4                2.83                       0                29
    ## 5                5.04                       0                36
    ## 6                2.51                       0                38
    ##   FairlyActiveMinutes LightlyActiveMinutes SedentaryMinutes Calories
    ## 1                  13                  328              728     1985
    ## 2                  19                  217              776     1797
    ## 3                  11                  181             1218     1776
    ## 4                  34                  209              726     1745
    ## 5                  10                  221              773     1863
    ## 6                  20                  164              539     1728

``` r
# For datafile sleep_day, keep the date but ignore the time. 
sleep_day <- sleep_day %>% 
    rename(SleepDate= SleepDay) %>% 
    mutate(SleepDate= as_date(SleepDate, format= "%m/%d/%Y %I:%M:%S %p"))
head(sleep_day)
```

    ##           Id  SleepDate TotalSleepRecords TotalMinutesAsleep TotalTimeInBed
    ## 1 1503960366 2016-04-12                 1                327            346
    ## 2 1503960366 2016-04-13                 2                384            407
    ## 3 1503960366 2016-04-15                 1                412            442
    ## 4 1503960366 2016-04-16                 2                340            367
    ## 5 1503960366 2016-04-17                 1                700            712
    ## 6 1503960366 2016-04-19                 1                304            320

``` r
# To make sure the date&time in the correct format for hourly_steps, hourly_intensities and hourly_calories.

hourly_calories <- hourly_calories %>% 
    rename(CaloriesDateTime = ActivityHour) %>% 
    mutate(CaloriesDateTime= as.POSIXct(CaloriesDateTime, format= "%m/%d/%Y %I:%M:%S %p"), tz=Sys.timezone())
head(hourly_calories)
```

    ##           Id    CaloriesDateTime Calories               tz
    ## 1 1503960366 2016-04-12 00:00:00       81 America/New_York
    ## 2 1503960366 2016-04-12 01:00:00       61 America/New_York
    ## 3 1503960366 2016-04-12 02:00:00       59 America/New_York
    ## 4 1503960366 2016-04-12 03:00:00       47 America/New_York
    ## 5 1503960366 2016-04-12 04:00:00       48 America/New_York
    ## 6 1503960366 2016-04-12 05:00:00       48 America/New_York

``` r
hourly_intensities <- hourly_intensities %>% 
    rename(IntensitiesDateTime = ActivityHour) %>% 
    mutate(IntensitiesDateTime= as.POSIXct(IntensitiesDateTime, format= "%m/%d/%Y %I:%M:%S %p"), tz=Sys.timezone())
head(hourly_intensities)
```

    ##           Id IntensitiesDateTime TotalIntensity AverageIntensity
    ## 1 1503960366 2016-04-12 00:00:00             20         0.333333
    ## 2 1503960366 2016-04-12 01:00:00              8         0.133333
    ## 3 1503960366 2016-04-12 02:00:00              7         0.116667
    ## 4 1503960366 2016-04-12 03:00:00              0         0.000000
    ## 5 1503960366 2016-04-12 04:00:00              0         0.000000
    ## 6 1503960366 2016-04-12 05:00:00              0         0.000000
    ##                 tz
    ## 1 America/New_York
    ## 2 America/New_York
    ## 3 America/New_York
    ## 4 America/New_York
    ## 5 America/New_York
    ## 6 America/New_York

``` r
hourly_steps <- hourly_steps %>% 
    rename(StepsDateTime = ActivityHour) %>% 
    mutate(StepsDateTime= as.POSIXct(StepsDateTime, format= "%m/%d/%Y %I:%M:%S %p"), tz=Sys.timezone())
head(hourly_steps) 
```

    ##           Id       StepsDateTime StepTotal               tz
    ## 1 1503960366 2016-04-12 00:00:00       373 America/New_York
    ## 2 1503960366 2016-04-12 01:00:00       160 America/New_York
    ## 3 1503960366 2016-04-12 02:00:00       151 America/New_York
    ## 4 1503960366 2016-04-12 03:00:00         0 America/New_York
    ## 5 1503960366 2016-04-12 04:00:00         0 America/New_York
    ## 6 1503960366 2016-04-12 05:00:00         0 America/New_York

### 4.4. Renaming datafile

<br> <br>

## 5. ANALYZE AND VISUALIZE

### 5.1. Statistic Summary of overall daily_activity and sleep_day

``` r
# daily_activity
daily_activity %>%  
  select(TotalSteps,
         TotalDistance,
         VeryActiveMinutes,
         FairlyActiveMinutes,
         LightlyActiveMinutes,
         SedentaryMinutes,
         Calories) %>%
  summary()
```

    ##    TotalSteps    TotalDistance    VeryActiveMinutes FairlyActiveMinutes
    ##  Min.   :    0   Min.   : 0.000   Min.   :  0.00    Min.   :  0.00     
    ##  1st Qu.: 3790   1st Qu.: 2.620   1st Qu.:  0.00    1st Qu.:  0.00     
    ##  Median : 7406   Median : 5.245   Median :  4.00    Median :  6.00     
    ##  Mean   : 7638   Mean   : 5.490   Mean   : 21.16    Mean   : 13.56     
    ##  3rd Qu.:10727   3rd Qu.: 7.713   3rd Qu.: 32.00    3rd Qu.: 19.00     
    ##  Max.   :36019   Max.   :28.030   Max.   :210.00    Max.   :143.00     
    ##  LightlyActiveMinutes SedentaryMinutes    Calories   
    ##  Min.   :  0.0        Min.   :   0.0   Min.   :   0  
    ##  1st Qu.:127.0        1st Qu.: 729.8   1st Qu.:1828  
    ##  Median :199.0        Median :1057.5   Median :2134  
    ##  Mean   :192.8        Mean   : 991.2   Mean   :2304  
    ##  3rd Qu.:264.0        3rd Qu.:1229.5   3rd Qu.:2793  
    ##  Max.   :518.0        Max.   :1440.0   Max.   :4900

``` r
cat("\n") # to print an empty row
```

``` r
# sleep_day
sleep_day2 %>%  
  select(TotalSleepRecords,
  TotalMinutesAsleep,
  TotalTimeInBed) %>%
  summary()
```

    ##  TotalSleepRecords TotalMinutesAsleep TotalTimeInBed 
    ##  Min.   :1.00      Min.   : 58.0      Min.   : 61.0  
    ##  1st Qu.:1.00      1st Qu.:361.0      1st Qu.:403.8  
    ##  Median :1.00      Median :432.5      Median :463.0  
    ##  Mean   :1.12      Mean   :419.2      Mean   :458.5  
    ##  3rd Qu.:1.00      3rd Qu.:490.0      3rd Qu.:526.0  
    ##  Max.   :3.00      Max.   :796.0      Max.   :961.0

The daily_activity dataset shows **the average steps per day was 7638,
which is less than the recommended 10,000 steps per day**. A study in
JAMA Neurology found that walking about 10,000 steps a day was linked to
less cardiovascular disease (heart disease, stroke and heart failure),
13 types of cancer, and dementia.

The sleep_day dataset show the average total time in bed (459 min = 7.7
hours) and aveagre total sleep time (419.2 min= approx 7 hours). There
isn’t sign of insomnia in this population. **This population allocate
enough time to bed and they have average total sleep time of 7 hrs
indicating adequate sleep**. However this dataset does not include
information in sleep quality. Sleep quality is as important as the sleep
quantity
(<https://www.mayoclinic.org/healthy-lifestyle/adult-health/expert-answers/how-many-hours-of-sleep-are-enough/faq-20057898>).

# Visualize the data distrubution of the daily activities.

``` r
# Visualize the data distrubution of the daily activities.

plot1 <- ggplot(data = daily_activity, aes(x=VeryActiveMinutes)) + geom_freqpoly(bins=30)+labs(title="Distribution of Very Activy Time", x="Very Active time in Minutes", y = "Total count")

plot2 <- ggplot(data = daily_activity, aes(x=FairlyActiveMinutes)) + geom_freqpoly(bins=30)+labs(title="Distribution of Fairly Activy Time", x="Fairly Active time in Minutes", y = "Total count")

plot4 <- ggplot(data = daily_activity, aes(x=SedentaryMinutes)) + geom_freqpoly(bins=30)+labs(title="Distribution of Sedentary Time", x="Sedentary time in Minutes", y = "Total count")

plot3 <- ggplot(data = daily_activity, aes(x=LightlyActiveMinutes)) + geom_freqpoly(bins=30)+labs(title="Distribution of Lightly Active Time", x="Lightly Active time in Minutes", y = "Total count")

# Set the size of the plotting device
options(repr.plot.width = 12, repr.plot.height = 10)

# Create the plot grid
grid.arrange(plot1, plot2, plot3, plot4, ncol=2)
```

![](bellabeat_files/figure-gfm/daily%20activities%20distribution-1.png)<!-- -->

Both Very Acitive and Fairly active distribution showed a significant
scewed of the distribution indicate **few people are being very active
or fairly active, most are lightly active or sendetary**. This confirmed
with the distribution of Sendentary time. On everage most people spent
16.5 hours being sedentary.

``` r
# Add new column -- Weekday, and then calculate the mean and sd. 
daily_activity_stat <- daily_activity %>% 
    mutate(weekday = weekdays(ActivityDate)%>%
           factor(levels =c("Monday", "Tuesday","Wednesday", "Thursday", "Friday","Saturday", "Sunday")))%>%
    group_by(weekday)%>% 
    summarize(avg_SedentaryMinutes = mean(SedentaryMinutes), 
                sd_SedentaryMinutes = sd(SedentaryMinutes),
                avg_VeryActiveMinutes = mean(VeryActiveMinutes),
                sd_VeryActiveMinutes = sd(VeryActiveMinutes),
                avg_FairlyActiveMinutes = mean(FairlyActiveMinutes),
                sd_FairlyActiveMinutes = sd(FairlyActiveMinutes),
                avg_LightlyActiveMinutes = mean(LightlyActiveMinutes),
                sd_LightlyActiveMinutes = sd(LightlyActiveMinutes),
                avg_Calories = mean(Calories),
                sd_Calories = sd(Calories))

# head(daily_activity_stat) -- remove comment# to see the table for the below figure     

plot5 <- ggplot(data=daily_activity_stat, aes(x=weekday, y=avg_SedentaryMinutes)) + geom_col(fill="blue")+ geom_errorbar(aes(ymin=avg_SedentaryMinutes-sd_SedentaryMinutes, ymax=avg_SedentaryMinutes+sd_SedentaryMinutes),width=0.4, position=position_dodge(width=0.9))
plot6 <- ggplot(data=daily_activity_stat, aes(x=weekday, y=avg_VeryActiveMinutes)) + geom_col(fill="red") + geom_errorbar(aes(ymin=avg_VeryActiveMinutes-sd_VeryActiveMinutes, ymax=avg_VeryActiveMinutes+sd_VeryActiveMinutes),width=0.4, position=position_dodge(width=0.9))
plot7 <- ggplot(data=daily_activity_stat, aes(x=weekday, y=avg_FairlyActiveMinutes)) + geom_col(fill="orange") + geom_errorbar(aes(ymin=avg_FairlyActiveMinutes-sd_FairlyActiveMinutes, ymax=avg_FairlyActiveMinutes+sd_FairlyActiveMinutes),width=0.4, position=position_dodge(width=0.9))
plot8 <- ggplot(data=daily_activity_stat, aes(x=weekday, y=avg_LightlyActiveMinutes)) + geom_col(fill="yellow") + geom_errorbar(aes(ymin=avg_LightlyActiveMinutes-sd_LightlyActiveMinutes, ymax=avg_LightlyActiveMinutes+sd_LightlyActiveMinutes),width=0.4, position=position_dodge(width=0.9))

# Set the size of the plotting device
options(repr.plot.width = 12, repr.plot.height = 12)

# Create the plot grid
grid.arrange(plot5, plot6, plot7, plot8, ncol=2)
```

![](bellabeat_files/figure-gfm/daily%20activities%20weekday%20plot-1.png)<!-- -->

Note that **physical activities remain consistent across all days of the
week**. Error bars overlapping indicate no statistical difference in
mean values of sedentary time, VeryActive time, FarilyActive time, and
Lightly_active time among the weekdays. The large error bars indicate
braod data distribution consist of data points much higher or lower than
the mean values.

### 5.3. Is there any difference in calories burned in different days in a week?

``` r
ggplot(data=daily_activity_stat, aes(x=weekday, y=avg_Calories)) + 
    geom_col(fill="brown") + 
    geom_errorbar(aes(ymin=avg_LightlyActiveMinutes-sd_LightlyActiveMinutes, ymax=avg_Calories+sd_Calories),width=0.2, position=position_dodge(width=0.7))
```

![](bellabeat_files/figure-gfm/weekday%20colories-1.png)<!-- -->

**There is no difference in calories burn across all days in a week.**

### 5.4. Is there any difference in sleep in different days in a week?

# Add new column – Weekday, and then calculate the mean and sd.

``` r
# Add new column -- Weekday, and then calculate the mean and sd.

sleep_day2_stat <- sleep_day %>% 
  mutate(weekday = weekdays(SleepDate, abbreviate = TRUE) %>% 
         factor(levels = c("Mon", "Tue", "Wed", "Thu", "Fri", "Sat", "Sun"))) %>% 
  group_by(weekday) %>% 
  summarize(avg_TotalMinutesAsleep = mean(TotalMinutesAsleep),
           sd_TotalMinutesAsleep= sd(TotalMinutesAsleep))

head(sleep_day2_stat)      
```

    ## # A tibble: 6 × 3
    ##   weekday avg_TotalMinutesAsleep sd_TotalMinutesAsleep
    ##   <fct>                    <dbl>                 <dbl>
    ## 1 Mon                       419.                 119. 
    ## 2 Tue                       405.                  96.1
    ## 3 Wed                       435.                  90.0
    ## 4 Thu                       402.                 102. 
    ## 5 Fri                       405.                 113. 
    ## 6 Sat                       421.                 154.

``` r
ggplot(data=sleep_day2_stat, aes(x=weekday, y=avg_TotalMinutesAsleep)) + 
    geom_col(fill="pink")+ 
    geom_errorbar(aes(ymin=avg_TotalMinutesAsleep-sd_TotalMinutesAsleep, ymax=avg_TotalMinutesAsleep+ sd_TotalMinutesAsleep),width=0.4, position=position_dodge(width=0.9))+
    labs(title = "Calories by Hour of the Day", x= "weekday", y ="Time")
```

![](bellabeat_files/figure-gfm/weekday%20sleep%20time-1.png)<!-- -->

Note that **total sleep time remain consistent across all days of the
week**. Overlapping of all errorbars indicate no statistical different
in total sleep time among days in a week.

### 5.5 Hourly Steps, Intensities and Calories

``` r
# Separate the StepsDateTime in hourly_steps, hourly_intensities and hourly calories datasets into date and time
hourly_steps <- hourly_steps %>% 
    separate(StepsDateTime, into=c("date", "time"), sep = " ") %>% 
    mutate(date=ymd(date))
head (hourly_steps)
```

    ##           Id       date     time StepTotal               tz
    ## 1 1503960366 2016-04-12 00:00:00       373 America/New_York
    ## 2 1503960366 2016-04-12 01:00:00       160 America/New_York
    ## 3 1503960366 2016-04-12 02:00:00       151 America/New_York
    ## 4 1503960366 2016-04-12 03:00:00         0 America/New_York
    ## 5 1503960366 2016-04-12 04:00:00         0 America/New_York
    ## 6 1503960366 2016-04-12 05:00:00         0 America/New_York

``` r
hourly_calories <- hourly_calories %>% 
    separate(CaloriesDateTime, into=c("date", "time"), sep = " ") %>% 
    mutate(date=ymd(date))
head (hourly_calories)
```

    ##           Id       date     time Calories               tz
    ## 1 1503960366 2016-04-12 00:00:00       81 America/New_York
    ## 2 1503960366 2016-04-12 01:00:00       61 America/New_York
    ## 3 1503960366 2016-04-12 02:00:00       59 America/New_York
    ## 4 1503960366 2016-04-12 03:00:00       47 America/New_York
    ## 5 1503960366 2016-04-12 04:00:00       48 America/New_York
    ## 6 1503960366 2016-04-12 05:00:00       48 America/New_York

``` r
hourly_intensities <- hourly_intensities %>% 
    separate(IntensitiesDateTime, into=c("date", "time"), sep = " ") %>% 
    mutate(date=ymd(date))
head (hourly_intensities)
```

    ##           Id       date     time TotalIntensity AverageIntensity
    ## 1 1503960366 2016-04-12 00:00:00             20         0.333333
    ## 2 1503960366 2016-04-12 01:00:00              8         0.133333
    ## 3 1503960366 2016-04-12 02:00:00              7         0.116667
    ## 4 1503960366 2016-04-12 03:00:00              0         0.000000
    ## 5 1503960366 2016-04-12 04:00:00              0         0.000000
    ## 6 1503960366 2016-04-12 05:00:00              0         0.000000
    ##                 tz
    ## 1 America/New_York
    ## 2 America/New_York
    ## 3 America/New_York
    ## 4 America/New_York
    ## 5 America/New_York
    ## 6 America/New_York

``` r
# Visualization of Steps, calories burned and activities intensities by hour in a day. (plot 9, 10, 11) 
hourly_steps_avg <- hourly_steps %>% 
    group_by(time) %>% 
    summarize (average_steps = mean(StepTotal))
head(hourly_steps_avg)
```

    ## # A tibble: 6 × 2
    ##   time     average_steps
    ##   <chr>            <dbl>
    ## 1 00:00:00         42.2 
    ## 2 01:00:00         23.1 
    ## 3 02:00:00         17.1 
    ## 4 03:00:00          6.43
    ## 5 04:00:00         12.7 
    ## 6 05:00:00         43.9

``` r
plot9 <- ggplot(data = hourly_steps_avg)+ 
geom_col (mapping=aes(x=time, y=average_steps, fill = average_steps))+
labs(title = "Steps by Hour of the Day", x= "Total Steps", y ="Time")+
scale_fill_gradient(low= "yellow", high="red")+
theme(axis.text.x= element_text(angle=45))
```

``` r
hourly_intensities_avg <- hourly_intensities %>% 
    group_by(time) %>% 
    summarize (average_intensity= mean(TotalIntensity))
head(hourly_intensities_avg)
```

    ## # A tibble: 6 × 2
    ##   time     average_intensity
    ##   <chr>                <dbl>
    ## 1 00:00:00             2.13 
    ## 2 01:00:00             1.42 
    ## 3 02:00:00             1.04 
    ## 4 03:00:00             0.444
    ## 5 04:00:00             0.633
    ## 6 05:00:00             4.95

``` r
plot10 <- ggplot(data = hourly_intensities_avg)+ 
geom_col (mapping=aes(x=time, y=average_intensity, fill = average_intensity))+
labs(title = "Intensity by Hour of the Day", x= "Total Intensity", y ="Time")+
scale_fill_gradient(low= "yellow", high="brown")+
theme(axis.text.x= element_text(angle=45))
```

``` r
hourly_calory_avg <- hourly_calories %>% 
    group_by(time) %>% 
    summarize (average_calory= mean(Calories))
head(hourly_calory_avg)
```

    ## # A tibble: 6 × 2
    ##   time     average_calory
    ##   <chr>             <dbl>
    ## 1 00:00:00           71.8
    ## 2 01:00:00           70.2
    ## 3 02:00:00           69.2
    ## 4 03:00:00           67.5
    ## 5 04:00:00           68.3
    ## 6 05:00:00           81.7

``` r
plot11 <- ggplot(data = hourly_calory_avg)+ 
geom_col (mapping=aes(x=time, y=average_calory, fill =average_calory))+
labs(title = "Calories by Hour of the Day", x= "Total Calories", y ="Time")+
scale_fill_gradient(low= "yellow", high="blue")+
theme(axis.text.x= element_text(angle=45))
```

``` r
# Set the size of the plotting device
options(repr.plot.width = 12, repr.plot.height = 12)

# Create the plot grid
grid.arrange(plot9, plot10, plot11, ncol=1)
```

![](bellabeat_files/figure-gfm/resizing%20plots-1.png)<!-- -->

**People tend to take more steps during lunch hours (12-2pm) and after
work hours (5-8pm)**, and this aligns with the overall activity
intensity level and calorie burn throughout the day.

### 5.6.Relationship between total steps taken and being sedentary in a day.

``` r
ggplot(data=daily_activity, aes(x=TotalSteps, y=SedentaryMinutes)) + 
    geom_point()+
    geom_smooth(color="blue",method = 'loess',formula = y ~ x)+
    stat_cor(method="pearson", label.x =20000, label.y=250)+
    labs(title='Do sedentary people tend to walk less?', x = 'Total Steps', y='Total Sedentary Time (minutes)')+
    theme_minimal()
```

![](bellabeat_files/figure-gfm/relationship%20between%20steps%20and%20being%20sedentary-1.png)<!-- -->

The above plot indicates majority of participants walk less than 15000
steps a day.

There does not appear to be a strong correlation between sedentary time
and total steps (R=0.33). **This suggests that individuals who are more
active do not necessarily focus solely on increasing their step count**,
but rather may engage in higher intensity activities instead.

### 5.7. Relationship between minutes asleep and time in bed

``` r
ggplot(data=sleep_day, aes(x=TotalMinutesAsleep, y=TotalTimeInBed)) +
    geom_point()+
    geom_smooth(method = 'loess', formula = y ~ x, color ='red')+  
    stat_cor(method = "pearson", label.x=300, label.y = 100)+
    labs(title="Does spending more time in bed result in more sleep?", x='Total sleep time (minute)', y='Total time spent in Bed (minute)')+
    theme_minimal()
```

![](bellabeat_files/figure-gfm/asleep%20vs%20in%20bed-1.png)<!-- -->

The correlation between TotalTimeInBed and TotalMinuteAsleep is strong,
with R=0.93. This suggests that there is a significant positive
relationship between the two variables, meaning **people who spend more
time in bed generally get more sleep.**

Let’s explore the data points that is NOT on the linear trend. I am
interested to know how many unique participants contributing to these
data points. I’ll add a new colum name TotalTimeNotSleep into the
sleep_day2 dataframe, and then plot a visual. <br> <br>

#### Time in bed but Not Asleep

``` r
sleep_day2 <- sleep_day2%>% 
    mutate(TotalTimeNotSleep = TotalTimeInBed - TotalMinutesAsleep)
```

``` r
ggplot(data = sleep_day2, aes(x=TotalTimeNotSleep)) + 
    geom_freqpoly(bins=30)+
    labs(title="How long do people usually stay awake at night?", x='Total awake time (minute)', y='Count')+
    theme_minimal()
```

![](bellabeat_files/figure-gfm/plot%20above-1.png)<!-- -->

``` r
ggplot(data = sleep_day2, aes("", TotalTimeNotSleep)) +
  geom_boxplot() +
  stat_summary(fun = mean, geom = "point", shape = 18, size = 3, color = "red") +
  stat_summary(fun = median, geom = "point", shape = 18, size = 3, color = "green") +
  stat_summary(fun.data = "median_hilow", geom = "errorbar", width = 0.2, color = "blue")
```

![](bellabeat_files/figure-gfm/boxplot%20TotalTimeNotSleep-1.png)<!-- -->

On average awake time in bed is less than 50 min. Next, let’s
investigate how many distinct participant are has more than 200 mins of
TotalTimeNotSleep.

``` r
not_sleep_well <- sleep_day2 %>% filter(TotalTimeNotSleep >= 200)
n_distinct(not_sleep_well$Id)
```

    ## [1] 2

Note 1: There are **2 (out of 24) individuals has significant longer
TotalTimeNotSleep when in bed.** <br> <br>

#### Merging datasets daily_activity and sleep_day2

Note merge() join reults in 24 unique participants, full_join() has 33.
This suggests that there are some rows in one or both of the data frames
that do not have a matching value in the other data frame. full_join()
include all rows from both data frames and fill in missing values with
NA.

``` r
# merging data
combined_data <- merge(sleep_day2, daily_activity, by="Id")

# Count number of unique participants
n_distinct(combined_data$Id)
```

    ## [1] 24

``` r
glimpse(combined_data)
```

    ## Rows: 12,348
    ## Columns: 20
    ## $ Id                       <dbl> 1503960366, 1503960366, 1503960366, 150396036…
    ## $ SleepDay                 <chr> "4/12/2016 12:00:00 AM", "4/12/2016 12:00:00 …
    ## $ TotalSleepRecords        <int> 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, …
    ## $ TotalMinutesAsleep       <int> 327, 327, 327, 327, 327, 327, 327, 327, 327, …
    ## $ TotalTimeInBed           <int> 346, 346, 346, 346, 346, 346, 346, 346, 346, …
    ## $ TotalTimeNotSleep        <int> 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 19, 1…
    ## $ ActivityDate             <date> 2016-05-07, 2016-05-06, 2016-05-01, 2016-04-…
    ## $ TotalSteps               <int> 11992, 12159, 10602, 14673, 13162, 10735, 153…
    ## $ TotalDistance            <dbl> 7.71, 8.03, 6.81, 9.25, 8.50, 6.97, 9.80, 8.9…
    ## $ TrackerDistance          <dbl> 7.71, 8.03, 6.81, 9.25, 8.50, 6.97, 9.80, 8.9…
    ## $ LoggedActivitiesDistance <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
    ## $ VeryActiveDistance       <dbl> 2.46, 1.97, 2.29, 3.56, 1.88, 1.57, 5.29, 2.9…
    ## $ ModeratelyActiveDistance <dbl> 2.12, 0.25, 1.60, 1.42, 0.55, 0.69, 0.57, 1.0…
    ## $ LightActiveDistance      <dbl> 3.13, 5.81, 2.92, 4.27, 6.06, 4.71, 3.94, 4.8…
    ## $ SedentaryActiveDistance  <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, …
    ## $ VeryActiveMinutes        <int> 37, 24, 33, 52, 25, 21, 73, 45, 48, 16, 31, 7…
    ## $ FairlyActiveMinutes      <int> 46, 6, 35, 34, 13, 19, 14, 24, 28, 12, 23, 11…
    ## $ LightlyActiveMinutes     <int> 175, 289, 246, 217, 328, 217, 216, 250, 189, …
    ## $ SedentaryMinutes         <int> 833, 754, 730, 712, 728, 776, 814, 857, 782, …
    ## $ Calories                 <int> 1821, 1896, 1820, 1947, 1985, 1797, 2013, 195…

``` r
ggplot(data=combined_data, aes(x=TotalTimeNotSleep, y=TotalSteps)) + geom_point(color='red',size=0.8) + xlab("TotalTimeNotSleep (min)")
```

![](bellabeat_files/figure-gfm/TotalTimeNotSleep%20vs%20TotalSteps-1.png)<!-- -->

Graph indicate most poeple sleep well regardless the total steps taken
per day. Also, those do not sleep well (higher totalTimeNotsleep) are
people with low steps. In another words, **individual who are active
(high total steps) during the day tend to sleep better at night with
least sleepless time when in bed**. However there is no correlation
showed in this graph indicating total sleep time not sleep is affected
by more complex factors other than just total distance recorded in a
day.

``` r
ggplot(data=combined_data, aes(x=TotalMinutesAsleep, y=TotalSteps)) + geom_point(color='blue',size=0.8) + xlab("TotalTimeAsleep (min)")
```

![](bellabeat_files/figure-gfm/TotalTimeAsleep%20vs%20TotalSteps-1.png)<!-- -->

Graph above show **no relationship between total sleep time and total
steps**. The same observations with total sleep time and any activity
intensities. <br> <br>

## 6. ACT: Recommendation and Conclusion

#### Physical activities and sleep behavior:

Physical activities is the most popular data user would engage to.
Perhpas it is the main reason many would want to have a wearable gardget
for. Some interesting finding derived from this analysis:

- The average steps per day was 7638, which is less than the recommended
  10,000 steps per day.
- This population allocate an average of 7.7hours to bed, and have
  average 7 hours of sleep, suggesting sufficient sleep.
- Few people are being very active or fairly active, most are lightly
  active or sedentary.
- There is no significant difference in physical activities, calories
  burn, and total sleep across all days of the week.
- People tend to take more steps during lunch hours (12-2pm) and after
  work hours (5-8pm). The activities intensity and calories burn are
  higher in these time periods too.
- Individuals who are more active do not necessarily focus solely on
  increasing their step counts, but engage in higher intensity
  activities instead.
- People who spend more time in bed generally get more sleep.
- Individual who are active (high total steps) during the day tend to
  sleep better at night with least sleepless time when in bed. However,
  total steps is not the sole factor affecting total sleepless time.
  instead it could be a combination of total activities, stress level,
  health condiction, etc. Anyway,user should be encourage to get involve
  in any activities that interest them to stay active in the day for
  better sleep at night.

Recommendation based on the finding include:

- create an app that send notification to users about their total
  physical activity in a day and if they have achieve their goal. Send
  message to encourage activity if they have not achieve their goal and
  congratulate and reward(star system) those who succeeded. The app
  should create weekly and monthly report on their achievement.

- Create an app to help user managea and monitor sleep time and quality.
  It would be interesting if Bellabeat could include an app to measure
  on sleep quality such as sleep latency, wakefulness, sleep efficiency,
  sleep walking (<https://www.thensf.org/what-is-sleep-quality/>), and
  provide a report on the sleep quality. Send notification to users who
  remain active after their normal sleep hour. Provide a selection of
  music that encourage sleep.

#### Weight log:

The usage of weight_log may be less engaging due to the manual input
requirement of weight, body fat, and BMI data.One possible way to make
weigh_log more useful and attractive is to explore additional variables
that may be of interest to users. For example, relating variables such
as exercise routine, dietary habits, and sleep patterns could provide
more context for weight fluctuations and enable users to identify
potential correlations or patterns.

Another recommendation would be to automate the data collection process
as much as possible, reducing the need for manual input and increasing
the accuracy and completeness of the data. This could involve connecting
wearable technology to equipment use to collect weight, body fat
percentage, and height data.

In addition, it may be useful to provide more attractive and
user-friendly visualizations and insights based on the individual data.
For instance, displaying trends in weight changes and body fat over
time, highlighting progress towards weight loss goals, or providing
personalized recommendations based on the user’s data could make the
weight_log dataset more engaging and useful.

#### Heart rate:

Heatrate by itself is not the most attractive piece of information. It
is useful for establishing a baseline for comparison and identy any
abnormalities in an individual user.

However when use in combination with other info such as. age, gender,
stress level and activity,heart rate can be use to monitor the health
status of an individual. Examining heart rate data over time can reveal
patterns that may indicate changes in cardiovascular health or fitness
level. For example, a gradual decrease in resting heart rate over time
may be a sign of improved fitness. A user will might be interested to
know if he/she achieve the desire level of fitness.

Factors such as stress, illness, or medication can all affect heart
rate, so it is important to take these into account when interpreting
the data. A user may be interested in receiving notifications if their
heart rate shows abnormalities, along with explanations for the possible
causes and suggestions for appropriate actions to take.

Accurately recording heart rate data is a key challenge in making this
information useful. While there are many wearable technology gadgets
currently available, few can achieve the required level of accuracy, and
some are too expensive to be incorporated into daily life. However, it
is not impossible to create a gadget that can provide accurate heart
rate data. Overcoming this challenge could pave the way for a range of
new applications for heart rate data, from personalized health
monitoring to performance tracking for athletes.

Diclaimer: Due to the small sample size of all datasets, analyses
generated from these datasets should be use with caution and subject to
further validation.

Personally I like a gadget that is beautiful and functional. It would be
even better if it is robust, weather proof, easy to use and need little
to no maintenance (e.g.long battery life).

##### Thank you for taking time to read my case study. I would greatly appreciate any comments and feedback. Your insight will be valuable in helping me improving my work.
